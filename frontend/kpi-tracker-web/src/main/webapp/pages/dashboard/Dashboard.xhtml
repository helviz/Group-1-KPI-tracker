<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/pages/californiatemplate/template.xhtml">

    <ui:define name="title">Dashboard</ui:define>
    <ui:define name="viewname">Admin Dashboard</ui:define>

    <ui:define name="head">
        <h:outputScript name="js/chart.js" library="demo"/>
        <h:outputStylesheet name="demo/css/dashboard.css"/>
    </ui:define>

    <ui:define name="content">
        <h:form id="dashboardForm">
            <div class="dashboard p-4" style="background-color: #f8f9fa;">
                <!-- Metrics Cards Row -->
                <div class="grid mb-4">
                    <div class="col-12 md:col-6 lg:col-3 mb-3">
                        <div class="dashboard-card">
                            <div class="metric-icon icon-goals">
                                <i class="pi pi-target"></i>
                            </div>
                            <div class="metric-label">Total Goals</div>
                            <div class="metric-value">#{dashboard.totalGoals != null ? dashboard.totalGoals : 27}</div>
                            <div class="metric-change positive">
                                <i class="pi pi-arrow-up"></i>
                                +3 This month
                            </div>
                        </div>
                    </div>

                    <div class="col-12 md:col-6 lg:col-3 mb-3">
                        <div class="dashboard-card">
                            <div class="metric-icon icon-users">
                                <i class="pi pi-users"></i>
                            </div>
                            <div class="metric-label">Active Users</div>
                            <div class="metric-value">#{dashboard.activeUsers != null ? dashboard.activeUsers : 27}</div>
                            <div class="metric-change positive">
                                <i class="pi pi-arrow-up"></i>
                                +3 This month
                            </div>
                        </div>
                    </div>

                    <div class="col-12 md:col-6 lg:col-3 mb-3">
                        <div class="dashboard-card">
                            <div class="metric-icon icon-kpis">
                                <i class="pi pi-chart-line"></i>
                            </div>
                            <div class="metric-label">Active KPIs</div>
                            <div class="metric-value">#{dashboard.activeKpis != null ? dashboard.activeKpis : 27}</div>
                            <div class="metric-change positive">
                                <i class="pi pi-arrow-right"></i>
                                +3 This quarter
                            </div>
                        </div>
                    </div>

                    <div class="col-12 md:col-6 lg:col-3 mb-3">
                        <div class="dashboard-card">
                            <div class="metric-icon icon-overdue">
                                <i class="pi pi-exclamation-triangle"></i>
                            </div>
                            <div class="metric-label">Overdue goals</div>
                            <div class="metric-value">#{dashboard.overdueGoals != null ? dashboard.overdueGoals : 27}</div>
                            <div class="metric-change positive">
                                <i class="pi pi-arrow-up"></i>
                                +3 This month
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Second Row of Metrics -->
                <div class="p-grid p-mb-4">
                    <div class="p-col-12 p-md-4 p-mb-3">
                        <div class="dashboard-card">
                            <div class="metric-icon icon-achieved">
                                <i class="pi pi-check-circle"></i>
                            </div>
                            <div class="metric-label">Achieved Goals</div>
                            <div class="metric-value">#{dashboard.achievedGoals != null ? dashboard.achievedGoals : 12}</div>
                            <div class="metric-change positive">
                                <i class="pi pi-arrow-up"></i>
                                +3 This month
                            </div>
                        </div>
                    </div>

                    <div class="p-col-12 p-md-4 p-mb-3">
                        <div class="dashboard-card">
                            <div class="metric-icon icon-pending">
                                <i class="pi pi-clock"></i>
                            </div>
                            <div class="metric-label">Pending approvals</div>
                            <div class="metric-value">#{dashboard.pendingApprovals != null ? dashboard.pendingApprovals : 27}</div>
                            <div class="metric-change positive">
                                <i class="pi pi-arrow-up"></i>
                                +3 This month
                            </div>
                        </div>
                    </div>

                    <div class="p-col-12 p-md-4 p-mb-3">
                        <div class="dashboard-card">
                            <div class="metric-icon icon-rewards">
                                <i class="pi pi-trophy"></i>
                            </div>
                            <div class="metric-label">Rewards issued</div>
                            <div class="metric-value">#{dashboard.rewardsIssued != null ? dashboard.rewardsIssued : 2}</div>
                            <div class="metric-change positive">
                                <i class="pi pi-arrow-up"></i>
                                +1 This month
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bottom Section: Activity Feed and Department Performance -->
                <div class="p-grid">
                    <!-- Recent Activity Feed -->
                    <div class="p-col-12 p-lg-7 p-mb-3">
                        <div class="activity-feed">
                            <div class="activity-header">
                                <div class="section-header" style="margin-bottom: 0; width: 100%;">
                                    <h3 class="section-title">
                                        <i class="pi pi-history p-mr-2"></i>
                                        Recent system Activity
                                    </h3>
                                    <p:commandLink styleClass="view-all-link" value="View All" />
                                </div>
                            </div>

                            <ui:repeat value="#{dashboard.recentActivities}" var="activity">
                                <div class="activity-item">
                                    <div class="activity-dot"></div>
                                    <div class="activity-content">
                                        <h6>#{activity.title}</h6>
                                        <p>#{activity.description}</p>
                                        <p>
                                            <i class="pi pi-clock p-mr-1"></i>
                                            #{activity.timeAgo} • #{activity.user}
                                        </p>
                                    </div>
                                </div>
                            </ui:repeat>

                            <!-- Default activities if none exist -->
                            <ui:fragment rendered="#{empty dashboard.recentActivities}">
                                <div class="activity-item">
                                    <div class="activity-dot"></div>
                                    <div class="activity-content">
                                        <h6>New Goal Created</h6>
                                        <p>Q4 Sales Target created by Semaganda</p>
                                        <p>
                                            <i class="pi pi-clock p-mr-1"></i>
                                            2 hours ago • Semaganda
                                        </p>
                                    </div>
                                </div>

                                <div class="activity-item">
                                    <div class="activity-dot"></div>
                                    <div class="activity-content">
                                        <h6>New Goal Created</h6>
                                        <p>Q4 Sales Target created by Semaganda</p>
                                        <p>
                                            <i class="pi pi-clock p-mr-1"></i>
                                            2 hours ago • Semaganda
                                        </p>
                                    </div>
                                </div>

                                <div class="activity-item">
                                    <div class="activity-dot"></div>
                                    <div class="activity-content">
                                        <h6>New Goal Created</h6>
                                        <p>Q4 Sales Target created by Semaganda</p>
                                        <p>
                                            <i class="pi pi-clock p-mr-1"></i>
                                            2 hours ago • Semaganda
                                        </p>
                                    </div>
                                </div>
                            </ui:fragment>
                        </div>
                    </div>

                    <!-- Department Performance -->
                    <div class="p-col-12 p-lg-5 p-mb-3">
                        <div class="department-performance">
                            <div class="section-header">
                                <h3 class="section-title">Department Performance</h3>
                                <p:selectOneMenu value="#{dashboard.selectedPeriod}" styleClass="p-mb-0">
                                    <f:selectItem itemLabel="Quarterly" itemValue="quarterly"/>
                                    <f:selectItem itemLabel="Monthly" itemValue="monthly"/>
                                    <f:selectItem itemLabel="Yearly" itemValue="yearly"/>
                                    <p:ajax update="@form" listener="#{dashboard.onPeriodChange}"/>
                                </p:selectOneMenu>
                            </div>

                            <ui:repeat value="#{dashboard.departmentPerformances}" var="dept">
                                <div class="department-item">
                                    <div class="department-info">
                                        <div class="department-dot dept-#{dept.name.toLowerCase()}"></div>
                                        <span class="department-name">#{dept.name}</span>
                                    </div>
                                    <div class="performance-info">
                                        <div class="progress-bar">
                                            <div class="progress-fill progress-#{dept.percentage}"></div>
                                        </div>
                                        <span class="performance-percentage">#{dept.percentage}%</span>
                                    </div>
                                </div>
                            </ui:repeat>

                            <!-- Default departments if none exist -->
                            <ui:fragment rendered="#{empty dashboard.departmentPerformances}">
                                <div class="department-item">
                                    <div class="department-info">
                                        <div class="department-dot dept-tech"></div>
                                        <span class="department-name">Tech</span>
                                    </div>
                                    <div class="performance-info">
                                        <div class="progress-bar">
                                            <div class="progress-fill progress-92"></div>
                                        </div>
                                        <span class="performance-percentage">92%</span>
                                    </div>
                                </div>

                                <div class="department-item">
                                    <div class="department-info">
                                        <div class="department-dot dept-sales"></div>
                                        <span class="department-name">Sales</span>
                                    </div>
                                    <div class="performance-info">
                                        <div class="progress-bar">
                                            <div class="progress-fill progress-42"></div>
                                        </div>
                                        <span class="performance-percentage">42%</span>
                                    </div>
                                </div>

                                <div class="department-item">
                                    <div class="department-info">
                                        <div class="department-dot dept-partnership"></div>
                                        <span class="department-name">Partnership</span>
                                    </div>
                                    <div class="performance-info">
                                        <div class="progress-bar">
                                            <div class="progress-fill progress-95"></div>
                                        </div>
                                        <span class="performance-percentage">95%</span>
                                    </div>
                                </div>

                                <div class="department-item">
                                    <div class="department-info">
                                        <div class="department-dot dept-hr"></div>
                                        <span class="department-name">HR</span>
                                    </div>
                                    <div class="performance-info">
                                        <div class="progress-bar">
                                            <div class="progress-fill progress-32"></div>
                                        </div>
                                        <span class="performance-percentage">32%</span>
                                    </div>
                                </div>
                            </ui:fragment>
                        </div>
                    </div>
                </div>
            </div>
        </h:form>
    </ui:define>
</ui:composition>