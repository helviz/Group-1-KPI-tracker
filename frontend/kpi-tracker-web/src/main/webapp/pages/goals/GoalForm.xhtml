<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui" template="/pages/californiatemplate/dialog-template.xhtml">

    <ui:define name="content">
        <title>Create New Goal</title>
        <h:form id="goalForm">

            <div class="formgrid grid p-4">
                <div class="field col-12">
                    <p:outputLabel for="goalTitle" value="Goal Name" />
                    <p:inputText id="goalTitle" value="#{goalForm.model.goalTitle}" required="true"
                        requiredMessage="Goal name is required" />
                    <p:message for="goalTitle" />
                </div>

                <div class="field col-12">
                    <p:outputLabel for="goalLevel" value="Goal level" />
                    <p:selectOneMenu id="goalLevel" value="#{goalForm.model.goalLevelId}" converter="goalLevelConverter"
                        styleClass="w-full">
                        <f:selectItem itemLabel="-- Select goal level --" itemValue="#{null}" />
                        <f:selectItems value="#{goalForm.goalLevels}" var="lvl" itemLabel="#{lvl.name}"
                            itemValue="#{lvl}" />
                    </p:selectOneMenu>
                    <p:message for="goalLevel" />
                </div>

                <div class="field col-12">
                    <p:outputLabel for="owner" value="Owner" />
                    <p:selectOneMenu id="owner" value="#{goalForm.model.ownerId}" styleClass="w-full">
                        <f:selectItems value="#{goalForm.users}" var="u" itemLabel="#{u.fullName}" itemValue="#{u}" />
                    </p:selectOneMenu>
                    <p:message for="owner" />
                </div>

                <div class="field col-12 md:col-6">
                    <p:outputLabel for="period" value="Period" />
                    <p:selectOneMenu id="period" value="#{goalForm.model.goalPeriod}" converter="goalPeriodConverter"
                        required="true">
                        <f:selectItem itemLabel="-- Select period --" itemValue="#{null}" />
                        <f:selectItems value="#{goalForm.goalPeriods}" var="p1" itemLabel="#{p1.periodName}"
                            itemValue="#{p1}" />
                    </p:selectOneMenu>
                    <p:message for="period" />
                </div>

                <div class="field col-12 md:col-6">
                    <p:outputLabel value="Due Date" />
                    <h:panelGroup>
                        <h:outputText
                            value="#{goalForm.model.goalPeriod != null ? goalForm.model.goalPeriod.endDate : null}">
                            <f:convertDateTime pattern="dd/MM/yyyy" />
                        </h:outputText>
                    </h:panelGroup>
                </div>

                <div class="field col-12">
                    <p:outputLabel for="department" value="Department" />
                    <p:selectOneMenu id="department" value="#{goalForm.model.departmentId}">
                        <f:selectItems value="#{goalForm.departments}" var="d" itemLabel="#{d.name}" itemValue="#{d}" />
                    </p:selectOneMenu>
                </div>

                <div class="field col-12">
                    <p:outputLabel for="status" value="Status" />
                    <p:selectOneMenu id="status" value="#{goalForm.model.goalStatus}">
                        <f:selectItems value="#{goalForm.statuses}" />
                    </p:selectOneMenu>
                </div>

                <div class="field col-12">
                    <p:outputLabel for="description" value="Description" />
                    <p:inputTextarea id="description" value="#{goalForm.model.description}" rows="4" />
                    <p:message for="description" />
                </div>

                <div class="field col-12 flex justify-content-end gap-2 p-2"
                    style="border-top: 1px solid var(--surface-d);">
                    <p:commandButton value="Cancel" icon="pi pi-times" immediate="true" process="@this"
                        actionListener="#{goalForm.hide}" styleClass="ui-button-outlined ui-button-danger" />
                    <p:commandButton value="Save Goal" icon="pi pi-check" process="@form"
                        actionListener="#{goalForm.save}" update="@form" />
                </div>
            </div>

        </h:form>
    </ui:define>

</ui:composition>