<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui" template="/pages/californiatemplate/dialog-template.xhtml">

    <ui:define name="head">
        <style type="text/css">
            .goal-form {
                padding: 1rem;
            }

            .field-label {
                font-weight: 500;
                margin-bottom: 0.5rem;
                color: #374151;
                display: block;
            }

            .required::after {
                content: " *";
                color: #dc2626;
            }

            .form-buttons {
                text-align: right;
                margin-top: 1.5rem;
                padding-top: 1rem;
            }

            .form-buttons .ui-button {
                margin-left: 0.5rem;
            }
        </style>
    </ui:define>

    <ui:define name="content">
        <div class="goal-form">
            <h:form id="goalForm">
                <p:messages id="messages" closable="true" showSummary="true" showDetail="false" />

                <!-- A single grid container for ALL form fields -->
                <div class="formgrid grid">

                    <!-- Row 1 -->
                    <div class="field col-12 md:col-6">
                        <p:outputLabel for="goalTitle" styleClass="field-label required">Goal Name</p:outputLabel>
                        <p:inputText id="goalTitle" value="#{goalForm.model.goalTitle}" required="true"
                                     requiredMessage="Goal name is required." placeholder="e.g., Increase sales" />
                        <p:message for="goalTitle" />
                    </div>

                    <div class="field col-12 md:col-6">
                        <p:outputLabel for="goalLevel" styleClass="field-label">Goal Level</p:outputLabel>
                        <p:selectOneMenu id="goalLevel" value="#{goalForm.model.goalLevelId}"
                                         converter="goalLevelConverter" filter="true" filterMatchMode="contains">
                            <f:selectItem itemLabel="Click to select goal level" itemValue="#{null}" />
                            <f:selectItems value="#{goalForm.goalLevels}" var="goalLevel" itemLabel="#{goalLevel.name}"
                                           itemValue="#{goalLevel}" />
                        </p:selectOneMenu>
                        <p:message for="goalLevel" />
                    </div>

                    <!-- Row 2 -->
                    <div class="field col-12 md:col-6">
                        <p:outputLabel for="period" styleClass="field-label required">Period</p:outputLabel>
                        <p:selectOneMenu id="period" value="#{goalForm.model.goalPeriod}"
                                         converter="goalPeriodConverter" required="true" filter="true" filterMatchMode="contains"
                                         requiredMessage="Period is required.">
                            <f:selectItem itemLabel="Select Period" itemValue="#{null}" />
                            <f:selectItems value="#{goalForm.goalPeriods}" var="p1" itemLabel="#{p1.periodName}"
                                           itemValue="#{p1}" />
                        </p:selectOneMenu>
                        <p:message for="period" />
                    </div>

                    <div class="field col-12 md:col-6">
                        <p:outputLabel for="departments" styleClass="field-label">Department</p:outputLabel>
                        <p:selectOneMenu id="departments" value="#{goalForm.model.department}"
                                         converter="departmentConverter" filter="true" filterMatchMode="contains">
                            <f:selectItem itemLabel="Select department" itemValue="#{null}" />
                            <f:selectItems value="#{goalForm.department}" var="d" itemLabel="#{d.name}"
                                           itemValue="#{d}" />
                        </p:selectOneMenu>
                        <p:message for="departments" />
                    </div>

                    <!-- Row 3 -->
                    <div class="field col-12 md:col-6">
                        <p:outputLabel for="status" styleClass="field-label">Status</p:outputLabel>
                        <p:selectOneMenu id="status" value="#{goalForm.model.goalStatus}">
                            <f:selectItem itemLabel="Select status" itemValue="#{null}" />
                            <f:selectItems value="#{goalForm.statuses}" />
                        </p:selectOneMenu>
                        <p:message for="status" />
                    </div>
                    <!-- Row 4 -->
                    <div class="field col-12">
                        <p:outputLabel for="description" styleClass="field-label">Description</p:outputLabel>
                        <p:inputTextarea id="description" value="#{goalForm.model.description}" rows="4"
                                         placeholder="Optional details about the goal" />
                        <p:message for="description" />
                    </div>
                </div> <!-- End of the single "formgrid grid" -->

                <div class="form-buttons">
                    <p:commandButton value="Cancel" validateClient="false" process="@this" action="#{goalForm.hide}"
                                     styleClass="ui-button-outlined" immediate="true" />

                    <p:commandButton value="Save Goal" process="@form" actionListener="#{goalForm.save}"
                                     update="@form messages" validateClient="true" />
                </div>

            </h:form>
        </div>
    </ui:define>
</ui:composition>